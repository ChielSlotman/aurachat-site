<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>AuraChat — Success</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
<nav>
  <div class="brand">
  <img src="logo/icon_only.png" alt="AuraChat logo" width="32" height="32" loading="lazy">
    <div class="name">AuraChat</div>
  </div>
  <div class="links">
    <a href="index.html">Home</a>
    <a href="support.html">Support</a>
  </div>
</nav>
<section class="hero">
  <h1>Payment received</h1>
  <p>Great! Now activate Premium in your extension.</p>
</section>
<section class="features">
  <div class="card" style="max-width:600px; margin-left:auto; margin-right:auto;">
    <h3>Next steps</h3>
    <ol>
      <li>Copy the activation code below.</li>
      <li>Open AuraChat extension and click <strong>Activate Premium</strong>.</li>
      <li>Paste the code and confirm.</li>
    </ol>
    <div style="display:flex; gap:0.5rem; flex-wrap:wrap;">
      <input id="codeBox" readonly value="" placeholder="Fetching code..." style="flex:1; padding:0.8rem; border-radius:8px; border:1px solid rgba(255,255,255,0.2); background:#111828; color:var(--text); letter-spacing:1px;">
      <button id="copyBtn" class="btn">Copy</button>
    </div>
    <p id="status" style="margin-top:0.5rem; opacity:0.8; font-size:0.9rem;"></p>
    <p class="small" style="opacity:0.7; font-size:0.8rem;">If the box stays empty for more than 10 seconds, refresh this page. If it still fails, contact us at <span id="contactMail"></span>.</p>
  </div>
</section>
<footer>
  AuraChat © 2025. Not affiliated with Character.AI.
</footer>
<script src="config.js"></script>
<script>
const cfg = window.AURACHAT_CONFIG || {};
document.getElementById('contactMail').textContent = cfg.CONTACT_EMAIL || '';
function getParam(name) {
  const url = new URL(window.location.href);
  return url.searchParams.get(name);
}
async function fetchCode() {
  const sid = getParam('session_id');
  if (!sid) {
    document.getElementById('status').textContent = 'Missing session_id in URL.';
    return;
  }
  try {
    const res = await fetch((cfg.BACKEND_BASE || '') + (cfg.EXCHANGE_PATH || '') + '?session_id=' + encodeURIComponent(sid));
    if (!res.ok) {
      document.getElementById('status').textContent = 'Backend returned an error.';
      return;
    }
    const data = await res.json();
    const code = (data.session || '').trim();
    document.getElementById('codeBox').value = code;
    document.getElementById('status').textContent = 'Code ready. Paste it in the extension.';
  } catch (e) {
    document.getElementById('status').textContent = 'Error fetching code. Try again.';
  }
}
document.getElementById('copyBtn').addEventListener('click', async () => {
  const code = document.getElementById('codeBox').value;
  try {
    await navigator.clipboard.writeText(code);
    document.getElementById('status').textContent = 'Copied!';
  } catch (e) {
    document.getElementById('status').textContent = 'Copy failed.';
  }
});
fetchCode();
</script>
</body>
</html>
